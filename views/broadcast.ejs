<%- include('partials/header') %>

<div class="max-w-4xl mx-auto px-4">
    <div class="mb-8">
        <h2 class="text-3xl font-black text-slate-900 tracking-tight">Broadcast Center</h2>
        <p class="text-slate-500 mt-1">Send an official internal announcement to the Unichem team.</p>
    </div>

    <div class="max-w-2xl">
        <% if (typeof success !== 'undefined' && success && success.length > 0) { %>
            <div class="mb-6 p-4 bg-emerald-50 border-l-4 border-emerald-500 rounded-r-xl flex items-center shadow-sm animate-pulse">
                <i class="fas fa-check-circle text-emerald-500 mr-3 text-xl"></i>
                <p class="text-emerald-800 font-bold"><%= success %></p>
            </div>
        <% } %>

        <% if (typeof errors !== 'undefined' && errors && errors.length > 0) { %>
            <div class="mb-6 p-4 bg-red-50 border-l-4 border-red-500 rounded-r-xl shadow-sm">
                <div class="flex items-center mb-2">
                    <i class="fas fa-exclamation-circle text-red-500 mr-3 text-xl"></i>
                    <p class="text-red-800 font-bold">Broadcast Failed</p>
                </div>
                <ul class="list-disc list-inside text-red-700 text-sm ml-9">
                    <% if (Array.isArray(errors)) { %>
                        <% errors.forEach(error => { %>
                            <li><%= error %></li>
                        <% }) %>
                    <% } else { %>
                        <li><%= errors %></li>
                    <% } %>
                </ul>
            </div>
        <% } %>

        <form action="/broadcast/send" method="POST" class="bg-white rounded-2xl shadow-sm border border-slate-100 p-8">
            
            <div class="mb-6">
                <label class="block text-sm font-bold text-slate-700 mb-2">Target Department</label>
                <select name="targetDepartment" class="w-full px-4 py-3 rounded-xl bg-slate-50 border-transparent focus:bg-white focus:ring-2 focus:ring-blue-500 outline-none transition">
                    <option value="All">All Departments</option>
                    <option value="HR">Human Resources</option>
                    <option value="IT">IT Support</option>
                    <option value="Sales">Sales & Marketing</option>
                    <option value="Operations">Operations</option>
                </select>
            </div>

            <div class="mb-6">
                <label class="block text-sm font-bold text-slate-700 mb-2">Subject Line</label>
                <input type="text" name="subject" required 
                    value="<%= typeof formData !== 'undefined' && formData.subject ? formData.subject : '' %>"
                    placeholder="e.g. Important Policy Update"
                    class="w-full px-4 py-3 rounded-xl bg-slate-50 border-transparent focus:bg-white focus:ring-2 focus:ring-blue-500 outline-none transition">
            </div>

            <div class="mb-6">
                <label class="block text-sm font-bold text-slate-700 mb-2">Message Body</label>
                <textarea name="message" rows="8" required placeholder="Write your announcement here..."
                    class="w-full px-4 py-3 rounded-xl bg-slate-50 border-transparent focus:bg-white focus:ring-2 focus:ring-blue-500 outline-none transition"><%= typeof formData !== 'undefined' && formData.message ? formData.message : '' %></textarea>
            </div>

            <button type="submit" class="w-full bg-slate-900 hover:bg-blue-600 text-white font-bold py-4 rounded-xl shadow-lg transition-all flex items-center justify-center group">
                <i class="fas fa-paper-plane mr-2 group-hover:translate-x-1 group-hover:-translate-y-1 transition-transform"></i>
                Send Broadcast Now
            </button>
        </form>
    </div>
</div>